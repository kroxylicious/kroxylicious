// file included in the following:
//
// assembly-configuring-record-encryption-filter

[id='con-example-kafkaprotocolfilter-resource-{context}']
= Example `KafkaProtocolFilter` resource

If your instance of Kroxylicious is running on Kubernetes you will need use a `KafkaProcotolFilter` resource to contain the filter configuration.

.Complete example `KafkaProtocolFilter` resource for a Record Encryption filter configuration using the Vault KMS
[source,yaml]
----
kind: KafkaProtocolFilter
metadata:
  name: my-encryption-filter
spec:
  type: RecordEncryption
  configTemplate:
    kms: VaultKmsService
    kmsConfig:
      vaultTransitEngineUrl: # ...
      tls: # ...
      vaultToken:
        passwordFile: ${secret:encryption-filter:vault-token}
    selector: TemplateKekSelector
    selectorConfig:
      template: "KEK_$(topicName)"
    unresolvedKeyPolicy: PASSTHROUGH_UNENCRYPTED
    experimental:
      encryptionDekRefreshAfterWriteSeconds: 3600
      encryptionDekExpireAfterWriteSeconds: 7200
      maxEncryptionsPerDek: 5000000
----

Refer to the Kroxylicious Operator for Kubernetes guide for more information about configuration on Kubernetes.