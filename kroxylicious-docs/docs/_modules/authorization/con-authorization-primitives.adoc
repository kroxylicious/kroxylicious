:_mod-docs-content-type: CONCEPT


[id='con-authorization-primitives-{context}']
= Authorization Primitives

Kafka clients send Kafka messages to perform operations on resources in Kafka.
It is required to know the operations and resources to effectively configure authorization checks.
This section lists these operations and resources, and then list the mapping between the Kafka messages and the operations and resources.

== Resource type and operations

This table lists the resources types and operations enforced by the authorization filter.

[id='authorization-resource-types-and-operations-{context}']
.Table of authorization primitives
|===
|Resource type|Operations

|Topic
|READ, WRITE, CREATE, DELETE ALTER, DESCRIBE, DESCRIBE_CONFIGS, ALTER_CONFIGS

|Cluster
|CREATE, ALTER, DESCRIBE, CLUSTER_ACTION, DESCRIBE_CONFIGS, ALTER_CONFIGS

|===

== Message, operation, and resource mapping


The table below lists the kafka messages for which the authorization filter will make authorization enforcements.
For each message, it shows the operation and resource type that will be tested.

[id='authorization-message-mapping-{context}']
.Table mapping the message to operation and resource
|===
|Api Key Id|Message|Operation|Resource|Note

// PRODUCE (0)
// |0
// |PRODUCE
// |Write
// |TransactionalId
// |A transactional producer which has its transactional.id set requires this privilege.

// // PRODUCE (0)
// |0
// |PRODUCE
// |IdempotentWrite
// |Cluster
// |An idempotent produce action requires this privilege.

// PRODUCE (0)
|0
|PRODUCE
|Write
|Topic
|This applies to a normal produce action.

// // FETCH (1)
// |1
// |FETCH
// |ClusterAction
// |Cluster
// |A follower must have ClusterAction on the Cluster resource in order to fetch partition data.

// FETCH (1)
|1
|FETCH
|Read
|Topic
|Regular Kafka consumers need READ permission on each partition they are fetching.

// LIST_OFFSETS (2)
|2
|LIST_OFFSETS
|Describe
|Topic
|

// METADATA (3)
|3
|METADATA
|Describe
|Topic
|

// METADATA (3)
// |3
// |METADATA
// |Create
// |Cluster
// |If topic auto-creation is enabled, then the broker-side API will check for the existence of a Cluster +
// level privilege. If it's found then it'll allow creating the topic, otherwise it'll iterate through the +
// Topic level privileges (see the next one).

// METADATA (3)
|3
|METADATA
|Create
|Topic
|This authorizes auto topic creation (if enabled)
// |This authorizes auto topic creation if enabled but the given user doesn't have a cluster level +
// permission (above).

// LEADER_AND_ISR (4) - removed API
// STOP_REPLICA (5) - removed API
// UPDATE_METADATA (6) - removed API
// CONTROLLED_SHUTDOWN (7) - removed API

// OFFSET_COMMIT (8)
// |8
// |OFFSET_COMMIT
// |Read
// |Group
// |An offset can only be committed if it's authorized to the given group and the topic too (see below). +
// Group access is checked first, then Topic access.

// OFFSET_COMMIT (8)
|8
|OFFSET_COMMIT
|Read
|Topic
|Since offset commit is part of the consuming process, it needs privileges for the read action.

// OFFSET_FETCH (9)
// |9
// |OFFSET_FETCH
// |Describe
// |Group
// |Similarly to OFFSET_COMMIT, the application must have privileges on group and topic level too to be able +
// to fetch. However in this case it requires describe access instead of read. Group access is checked first, +
// then Topic access.

// OFFSET_FETCH (9)
|9
|OFFSET_FETCH
|Describe
|Topic
|

// FIND_COORDINATOR (10)
// |10
// |FIND_COORDINATOR
// |Describe
// |Group
// |The FIND_COORDINATOR request can be of "Group" type in which case it is looking for consumergroup +
// coordinators. This privilege would represent the Group mode.

// FIND_COORDINATOR (10)
// |10
// |FIND_COORDINATOR
// |Describe
// |TransactionalId
// |This applies only on transactional producers and checked when a producer tries to find the transaction +
// coordinator.

// JOIN_GROUP (11)
// |11
// |JOIN_GROUP
// |Read
// |Group
// |

// HEARTBEAT (12)
// |12
// |HEARTBEAT
// |Read
// |Group
// |

// LEAVE_GROUP (13)
// |13
// |LEAVE_GROUP
// |Read
// |Group
// |

// SYNC_GROUP (14)
// |14
// |SYNC_GROUP
// |Read
// |Group
// |

// DESCRIBE_GROUPS (15)
// |15
// |DESCRIBE_GROUPS
// |Describe
// |Group
// |

// LIST_GROUPS (16)
// |16
// |LIST_GROUPS
// |Describe
// |Cluster
// |When the broker checks to authorize a list_groups request it first checks for this cluster +
// level authorization. If none found then it proceeds to check the groups individually. This operation +
// doesn't return CLUSTER_AUTHORIZATION_FAILED.

// LIST_GROUPS (16)
// |16
// |LIST_GROUPS
// |Describe
// |Group
// |If none of the groups are authorized, then just an empty response will be sent back instead +
// of an error. This operation doesn't return CLUSTER_AUTHORIZATION_FAILED. This is applicable from the +
// 2.1 release.

// SASL_HANDSHAKE (17)
|17
|SASL_HANDSHAKE
|
|
|The SASL handshake is part of the authentication process, and therefore it's not possible to +
apply any kind of authorization here.

// API_VERSIONS (18)
|18
|API_VERSIONS
|
|
|The API_VERSIONS request is part of the Kafka protocol handshake and happens on connection +
and before any authentication. Therefore, it's not possible to control this with authorization.

// CREATE_TOPICS (19)
// |19
// |CREATE_TOPICS
// |Create
// |Cluster
// |If there is no cluster level authorization then it won't return CLUSTER_AUTHORIZATION_FAILED but +
// fall back to use topic level, which is just below. That'll throw error if there is a problem.

// CREATE_TOPICS (19)
|19
|CREATE_TOPICS
|Create
|Topic
|

// DELETE_TOPICS (20)
|20
|DELETE_TOPICS
|Delete
|Topic
|

// DELETE_RECORDS (21)
|21
|DELETE_RECORDS
|Delete
|Topic
|

// INIT_PRODUCER_ID (22)
// |22
// |INIT_PRODUCER_ID
// |Write
// |TransactionalId
// |

// INIT_PRODUCER_ID (22)
// |22
// |INIT_PRODUCER_ID
// |IdempotentWrite
// |Cluster
// |

// OFFSET_FOR_LEADER_EPOCH (23)
// |23
// |OFFSET_FOR_LEADER_EPOCH
// |ClusterAction
// |Cluster
// |If there is no cluster level privilege for this operation, then it'll check for topic level one.

// OFFSET_FOR_LEADER_EPOCH (23)
|23
|OFFSET_FOR_LEADER_EPOCH
|Describe
|Topic
|

// ADD_PARTITIONS_TO_TXN (24)
// |24
// |ADD_PARTITIONS_TO_TXN
// |Write
// |TransactionalId
// |This API is only applicable to transactional requests. It first checks for the Write action on the +
// TransactionalId resource, then it checks the Topic in subject (below).

// ADD_PARTITIONS_TO_TXN (24)
|24
|ADD_PARTITIONS_TO_TXN
|Write
|Topic
|

// ADD_OFFSETS_TO_TXN (25)
// |25
// |ADD_OFFSETS_TO_TXN
// |Write
// |TransactionalId
// |Similarly to ADD_PARTITIONS_TO_TXN this is only applicable to transactional requests. It first checks +
// for Write action on the TransactionalId resource, then it checks whether it can Read on the given group +
// (below).

// ADD_OFFSETS_TO_TXN (25)
// |25
// |ADD_OFFSETS_TO_TXN
// |Read
// |Group
// |

// END_TXN (26)
// |26
// |END_TXN
// |Write
// |TransactionalId
// |

// WRITE_TXN_MARKERS (27)
// |27
// |WRITE_TXN_MARKERS
// |Alter
// |Cluster
// |

// WRITE_TXN_MARKERS (27)
// |27
// |WRITE_TXN_MARKERS
// |ClusterAction
// |Cluster
// |

// TXN_OFFSET_COMMIT (28)
// |28
// |TXN_OFFSET_COMMIT
// |Write
// |TransactionalId
// |

// TXN_OFFSET_COMMIT (28)
// |28
// |TXN_OFFSET_COMMIT
// |Read
// |Group
// |

// TXN_OFFSET_COMMIT (28)
|28
|TXN_OFFSET_COMMIT
|Read
|Topic
|

// DESCRIBE_ACLS (29)
// |29
// |DESCRIBE_ACLS
// |Describe
// |Cluster
// |

// CREATE_ACLS (30)
// |30
// |CREATE_ACLS
// |Alter
// |Cluster
// |

// DELETE_ACLS (31)
// |31
// |DELETE_ACLS
// |Alter
// |Cluster
// |

// DESCRIBE_CONFIGS (32)
// |32
// |DESCRIBE_CONFIGS
// |DescribeConfigs
// |Cluster
// |If broker configs are requested, then the broker will check cluster level privileges.

// DESCRIBE_CONFIGS (32)
// |32
// |DESCRIBE_CONFIGS
// |DescribeConfigs
// |Topic
// |If topic configs are requested, then the broker will check topic level privileges.

// ALTER_CONFIGS (33)
// |33
// |ALTER_CONFIGS
// |AlterConfigs
// |Cluster
// |If broker configs are altered, then the broker will check cluster level privileges.

// ALTER_CONFIGS (33)
|33
|ALTER_CONFIGS
|AlterConfigs
|Topic
|If topic configs are altered, then the filter will check topic level privileges.

// ALTER_REPLICA_LOG_DIRS (34)
// |34
// |ALTER_REPLICA_LOG_DIRS
// |Alter
// |Cluster
// |

// DESCRIBE_LOG_DIRS (35)
// |35
// |DESCRIBE_LOG_DIRS
// |Describe
// |Cluster
// |An empty response will be returned on authorization failure.

// SASL_AUTHENTICATE (36)
|36
|SASL_AUTHENTICATE
|
|
|SASL_AUTHENTICATE is part of the authentication process and therefore it's not possible to +
apply any kind of authorization here.

// CREATE_PARTITIONS (37)
|37
|CREATE_PARTITIONS
|Alter
|Topic
|

// CREATE_DELEGATION_TOKEN (38)
// |38
// |CREATE_DELEGATION_TOKEN
// |
// |
// |Creating delegation tokens has special rules, for this please see the +
// Authentication using Delegation Tokens section.

// CREATE_DELEGATION_TOKEN (38)
// |38
// |CREATE_DELEGATION_TOKEN
// |CreateTokens
// |User
// |Allows creating delegation tokens for the User resource.

// RENEW_DELEGATION_TOKEN (39)
// |39
// |RENEW_DELEGATION_TOKEN
// |
// |
// |Renewing delegation tokens has special rules, for this please see the +
// Authentication using Delegation Tokens section.

// EXPIRE_DELEGATION_TOKEN (40)
// |40
// |EXPIRE_DELEGATION_TOKEN
// |
// |
// |Expiring delegation tokens has special rules, for this please see the +
// Authentication using Delegation Tokens section.

// DESCRIBE_DELEGATION_TOKEN (41)
// |41
// |DESCRIBE_DELEGATION_TOKEN
// |Describe
// |DelegationToken
// |Describing delegation tokens has special rules, for this please see the +
// Authentication using Delegation Tokens section.

// DESCRIBE_DELEGATION_TOKEN (41)
// |41
// |DESCRIBE_DELEGATION_TOKEN
// |DescribeTokens
// |User
// |Allows describing delegation tokens of the User resource.

// DELETE_GROUPS (42)
// |42
// |DELETE_GROUPS
// |Delete
// |Group
// |

// ELECT_PREFERRED_LEADERS (43)
// |43
// |ELECT_PREFERRED_LEADERS
// |ClusterAction
// |Cluster
// |

// INCREMENTAL_ALTER_CONFIGS (44)
// |44
// |INCREMENTAL_ALTER_CONFIGS
// |AlterConfigs
// |Cluster
// |If broker configs are altered, then the broker will check cluster level privileges.

// INCREMENTAL_ALTER_CONFIGS (44)
|44
|INCREMENTAL_ALTER_CONFIGS
|AlterConfigs
|Topic
|If topic configs are altered, then the filter will check topic level privileges.

// ALTER_PARTITION_REASSIGNMENTS (45)
// |45
// |ALTER_PARTITION_REASSIGNMENTS
// |Alter
// |Cluster
// |

// LIST_PARTITION_REASSIGNMENTS (46)
// |46
// |LIST_PARTITION_REASSIGNMENTS
// |Describe
// |Cluster
// |

// OFFSET_DELETE (47)
// |47
// |OFFSET_DELETE
// |Delete
// |Group
// |

// OFFSET_DELETE (47)
|47
|OFFSET_DELETE
|Read
|Topic
|

// DESCRIBE_CLIENT_QUOTAS (48)
// |48
// |DESCRIBE_CLIENT_QUOTAS
// |DescribeConfigs
// |Cluster
// |

// ALTER_CLIENT_QUOTAS (49)
// |49
// |ALTER_CLIENT_QUOTAS
// |AlterConfigs
// |Cluster
// |

// DESCRIBE_USER_SCRAM_CREDENTIALS (50)
// |50
// |DESCRIBE_USER_SCRAM_CREDENTIALS
// |Describe
// |Cluster
// |

// ALTER_USER_SCRAM_CREDENTIALS (51)
// |51
// |ALTER_USER_SCRAM_CREDENTIALS
// |Alter
// |Cluster
// |

// VOTE (52) - clients don't send this api
// BEGIN_QUORUM_EPOCH (53) - clients don't send this api
// END_QUORUM_EPOCH (54) - clients don't send this api
// |

// DESCRIBE_QUORUM (55)
// |55
// |DESCRIBE_QUORUM
// |Describe
// |Cluster
// |

// ALTER_PARTITION (56)
// |56
// |ALTER_PARTITION
// |ClusterAction
// |Cluster
// |

// UPDATE_FEATURES (57)
// |57
// |UPDATE_FEATURES
// |Alter
// |Cluster
// |

// ENVELOPE (58) - clients don't send this api
// FETCH_SNAPSHOT (59) - clients don't send this api

// DESCRIBE_CLUSTER (60)
// |60
// |DESCRIBE_CLUSTER
// |Describe
// |Cluster
// |

// DESCRIBE_PRODUCERS (61)
|61
|DESCRIBE_PRODUCERS
|Read
|Topic
|

// BROKER_REGISTRATION (62) - clients don't send this api

// BROKER_HEARTBEAT (63) - clients don't send this api

// UNREGISTER_BROKER (64)
// |64
// |UNREGISTER_BROKER
// |Alter
// |Cluster
// |

// DESCRIBE_TRANSACTIONS (65)
// |65
// |DESCRIBE_TRANSACTIONS
// |Describe
// |TransactionalId
// |

// LIST_TRANSACTIONS (66)
// |66
// |LIST_TRANSACTIONS
// |Describe
// |TransactionalId
// |

// ALLOCATE_PRODUCER_IDS (67) - clients don't send this api

// CONSUMER_GROUP_HEARTBEAT (68)
// |68
// |CONSUMER_GROUP_HEARTBEAT
// |Read
// |Group
// |

// CONSUMER_GROUP_DESCRIBE (69)
// |69
// |CONSUMER_GROUP_DESCRIBE
// |Read
// |Group
// |

// CONTROLLER_REGISTRATION (70) - clients don't send this api

// GET_TELEMETRY_SUBSCRIPTIONS (71)
// |71
// |GET_TELEMETRY_SUBSCRIPTIONS
// |
// |
// |No authorization check is performed for this request.

// PUSH_TELEMETRY (72)
// |72
// |PUSH_TELEMETRY
// |
// |
// |No authorization check is performed for this request.

// ASSIGN_REPLICAS_TO_DIRS (73) - clients don't send this api

// LIST_CONFIG_RESOURCES (74)
// |74
// |LIST_CONFIG_RESOURCES
// |DescribeConfigs
// |Cluster
// |

// DESCRIBE_TOPIC_PARTITIONS (75)
|75
|DESCRIBE_TOPIC_PARTITIONS
|Describe
|Topic
|

// SHARE_GROUP_HEARTBEAT (76)
// |76
// |SHARE_GROUP_HEARTBEAT
// |Read
// |Group
// |

// SHARE_GROUP_DESCRIBE (77)
// |77
// |SHARE_GROUP_DESCRIBE
// |Describe
// |Group
// |

// SHARE_FETCH (78)
// |78
// |SHARE_FETCH
// |Read
// |Group
// |

// SHARE_FETCH (78)
// |78
// |SHARE_FETCH
// |Read
// |Topic

// SHARE_ACKNOWLEDGE (79)
// |79
// |SHARE_ACKNOWLEDGE
// |Read
// |Group
// |

// SHARE_ACKNOWLEDGE (79)
// |79
// |SHARE_ACKNOWLEDGE
// |Read
// |Topic

// INITIALIZE_SHARE_GROUP_STATE (83)
// |83
// |INITIALIZE_SHARE_GROUP_STATE
// |ClusterAction
// |Cluster
// |

// READ_SHARE_GROUP_STATE (84)
// |84
// |READ_SHARE_GROUP_STATE
// |ClusterAction
// |Cluster
// |

// WRITE_SHARE_GROUP_STATE (85)
// |85
// |WRITE_SHARE_GROUP_STATE
// |ClusterAction
// |Cluster
// |

// DELETE_SHARE_GROUP_STATE (86)
// |86
// |DELETE_SHARE_GROUP_STATE
// |ClusterAction
// |Cluster
// |

// READ_SHARE_GROUP_STATE_SUMMARY (87)
// |87
// |READ_SHARE_GROUP_STATE_SUMMARY
// |ClusterAction
// |Cluster
// |

// STREAMS_GROUP_HEARTBEAT (88)
// |88
// |STREAMS_GROUP_HEARTBEAT
// |Read
// |Group
// |

// STREAMS_GROUP_HEARTBEAT (88)
// |88
// |STREAMS_GROUP_HEARTBEAT
// |Describe
// |Topic
// |Required for all source topics and internal topics used in the topology of the group.

// STREAMS_GROUP_HEARTBEAT (88)
// |88
// |STREAMS_GROUP_HEARTBEAT
// |Create
// |Topic
// |Required for all internal topics, for the broker to automatically create internal topics. Not required if internal topics exist.

// STREAMS_GROUP_DESCRIBE (89)
// |89
// |STREAMS_GROUP_DESCRIBE
// |Describe
// |Group
// |

// STREAMS_GROUP_DESCRIBE (89)
// |89
// |STREAMS_GROUP_DESCRIBE
// |Describe
// |Topic
// |Required for all source topics and internal topics used in the topology of the group.

// DESCRIBE_SHARE_GROUP_OFFSETS (90)
// |90
// |DESCRIBE_SHARE_GROUP_OFFSETS
// |Describe
// |Group
// |To describe the offset information for a partition in a share group, the application must have privileges on the +
// group and the topic. Group access is checked first, then topic access.

// DESCRIBE_SHARE_GROUP_OFFSETS (90)
// |90
// |DESCRIBE_SHARE_GROUP_OFFSETS
// |Describe
// |Topic
// |

// ALTER_SHARE_GROUP_OFFSETS (91)
// |91
// |ALTER_SHARE_GROUP_OFFSETS
// |Read
// |Group
// |To alter the offset information for a partition in a share group, the application must have privileges on the +
// group and the topic. Group access is checked first, then topic access.

// ALTER_SHARE_GROUP_OFFSETS (91)
// |91
// |ALTER_SHARE_GROUP_OFFSETS
// |Read
// |Topic
// |

// DELETE_SHARE_GROUP_OFFSETS (92)
// |92
// |DELETE_SHARE_GROUP_OFFSETS
// |Delete
// |Group
// |To delete the offset information for a topic in a share group, the application must have privileges on the +
// group and the topic. Group access is checked first, then topic access.

// DELETE_SHARE_GROUP_OFFSETS (92)
// |92
// |DELETE_SHARE_GROUP_OFFSETS
// |Read
// |Topic
// |

|===

