:_mod-docs-content-type: CONCEPT


[id='con-authorization-rules-{context}']
= Authorization rules

The authorization rules define which users can perform specific operations on specific Kafka resources.
The basic form of a rule is as follows:

[source]
----
<allow|deny> User with <user predicate> to <operation> <resource type> with <resource predicate>;
----
where:

* `<allow|deny>` indicates whether to allow or deny the action.
* `<user predicate>` matches the user performing the action.
* `<resource type>` and `<resource predicate>` identifies the resource.
* `<operation>` identifies the operation(s) to be performed on the resource.

`<resource type>` must be declared before use.
This is achieved using a `from` statement in the following format:

[source]
----
from <package> import <element> [as <alias>][,... , <elementn> [as <aliasn>]];
----
where:

* <package> is `io.kroxylicious.filter.authorization`
* <element> is a `ResourceType` implementation. 
* <alias> is an optional alias for the resource type.

For example, `TopicResource` is the implementation that represents Kafka topics:

[source]
----
from io.kroxylicious.filter.authorization import TopicResource;
----

Rules files must end with the statement `otherwise deny`.
[source]
----
...
otherwise deny;
----

== User predicates

The following user predicates are supported:

|===
|Predicate|Description|Example

| `=`
| Equals
| `name = "alice"`

| `IN`
| Set inclusion
| `name in +{"alice", "bob"}+`

| `LIKE`
| Prefix (note that the wildcard * is only permitted at the end of the prefix.)
| `name like "bob*"`

|===

== Resource Predicates

The following resource predicates are supported:

|===
|Predicate|Description|Example

| `=`
| Equality
| `name = "mytopic"`

| `IN`
| Set inclusion
| `name in +{"topic1", "topic2"}+`

| `LIKE`
| Prefix (wildcard * is permitted only at the end)
| `name like "finance*"`

| `MATCHING`
| Regular expression match
| `name matching "a+"`

|===

== Operations

Operations in rules can be specified in the following ways:

* As a single operation, for example `READ`
* As a set of operations, for example `+{READ, WRITE}+`
* As a wildcard that matches any operation, for example `*`

NOTE: The Authorization filter does not support the keyword `ALL`.