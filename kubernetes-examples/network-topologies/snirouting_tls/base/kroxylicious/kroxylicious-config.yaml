#
# Copyright Kroxylicious Authors.
#
# Licensed under the Apache Software License version 2.0, available at http://www.apache.org/licenses/LICENSE-2.0
#

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: kroxylicious-config
data:
  config.yaml: |
    adminHttp:
      endpoints:
        prometheus: {}
    virtualClusters:
      my-cluster-proxy:
        targetCluster:
          bootstrapServers: my-cluster-kafka-bootstrap.kafka.svc.cluster.local:9093
          tls:
            trust:
              storeFile: /opt/kroxylicious/trust/ca.p12
              storePassword:
                passwordFile: /opt/kroxylicious/trust/ca.password
        clusterNetworkAddressConfigProvider:
          type: SniRoutingClusterNetworkAddressConfigProvider
          config:
            bootstrapAddress: mycluster-proxy.kafka:9092
            brokerAddressPattern: broker$(nodeId).mycluster-proxy.kafka
        logNetwork: false
        logFrames: false
        tls:
          key:
            keyPairs:
              - privateKeyFile: /opt/kroxylicious/server/key-material/tls.key
                certificateFile: /opt/kroxylicious/server/key-material/tls.crt
              - privateKeyFile: /opt/kroxylicious/server/key-material-2/tls.key
                certificateFile: /opt/kroxylicious/server/key-material-2/tls.crt
      my-cluster-proxy-2:
        targetCluster:
          bootstrapServers: my-cluster-kafka-bootstrap.kafka.svc.cluster.local:9093
          tls:
            trust:
              storeFile: /opt/kroxylicious/trust/ca.p12
              storePassword:
                passwordFile: /opt/kroxylicious/trust/ca.password
        clusterNetworkAddressConfigProvider:
          type: SniRoutingClusterNetworkAddressConfigProvider
          config:
            bootstrapAddress: mycluster-proxy-2.kafka:9092
            brokerAddressPattern: broker$(nodeId).mycluster-proxy-2.kafka
        logNetwork: false
        logFrames: false
        tls:
          key:
            keyPairs:
              - privateKeyFile: /opt/kroxylicious/server/key-material/tls.key
                certificateFile: /opt/kroxylicious/server/key-material/tls.crt
              - privateKeyFile: /opt/kroxylicious/server/key-material-2/tls.key
                certificateFile: /opt/kroxylicious/server/key-material-2/tls.crt
